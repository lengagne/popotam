#ifdef IPOPT_FOUND

#include "MinVariance.h"
       
MinVariance::MinVariance(): OptimizedBasisFunction("MinVariance")
{
    for (uint i=2;i<=6;i++)
    {
        Eigen::Matrix<double,Eigen::Dynamic,Eigen::Dynamic> M(i+1,i+1);
        switch(i)
        {
            
//  // roots
// 	root[0][0] = -0.673004
            case(2):
            // matrix 
                M(0,0) = 0.155868845744918160800552;
                M(0,1) = 0.688262308510163456354292;
                M(0,2) = 0.155868845744918105289401;
                M(1,0) = 0.463203306545218684853182;
                M(1,1) = -0;
                M(1,2) = -0.463203306545218462808577;
                M(2,0) = 0.344131154255081617154843;
                M(2,1) = -0.688262308510163456354292;
                M(2,2) = 0.34413115425508145062139;            
            
//             case(2):
//                 M(0,0) = 0.249987443692760158420185;
//                 M(0,1) = 0.500025112614479794181932;
//                 M(0,2) = 0.249987443692760158420185;
//                 M(1,0) = 0.499999999369356629141947;
//                 M(1,1) = -0;
//                 M(1,2) = -0.499999999369356629141947;
//                 M(2,0) = 0.250012556307239897090966;
//                 M(2,1) = -0.500025112614479794181932;
//                 M(2,2) = 0.250012556307239897090966;
//                 break;
                break;
            case(3):
// //             // roots
// //                 root[0][0] = -0.952253
// //                 root[2][0] = 0.34578
//                 M(0,0) = 0.467069386017669507804584;
//                 M(0,1) = 0.0329306139823304921954161;
//                 M(0,2) = 0.0329306139823304921954161;
//                 M(0,3) = 0.467069386017669507804584;
//                 M(1,0) = 0.513908306390168601041069;
//                 M(1,1) = 0.223402272459962164541381;
//                 M(1,2) = -0.223402272459962164541381;
//                 M(1,3) = -0.513908306390168601041069;
//                 M(2,0) = -0.465895104140427007699543;
//                 M(2,1) = 0.465895104140427007699543;
//                 M(2,2) = 0.465895104140427007699543;
//                 M(2,3) = -0.465895104140427007699543;
//                 M(3,0) = -0.515082588267411045634958;
//                 M(3,1) = 0.275423445662795307598003;
//                 M(3,2) = -0.275423445662795307598003;
//                 M(3,3) = 0.515082588267411045634958;                
//                 break;

                // roots
//                     root[0][0] = 0.246066
//                     root[2][0] = -0.895527

                // matrix 
                    M(0,0) = 0.0192429370180196186723709;
                    M(0,1) = 0.48075706298198067623062;
                    M(0,2) = 0.480757062981980454186015;
                    M(0,3) = 0.01924293701801960826403;
                    M(1,0) = -0.175647418312915776228422;
                    M(1,1) = -0.592927941919410117499467;
                    M(1,2) = 0.592927941919409895454862;
                    M(1,3) = 0.175647418312915692961695;
                    M(2,0) = 0.474214098223672386733796;
                    M(2,1) = -0.474214098223672386733796;
                    M(2,2) = -0.474214098223672220200342;
                    M(2,3) = 0.47421409822367210917804;
                    M(3,0) = -0.317809616928776184074934;
                    M(3,1) = 0.599470906677718406996291;
                    M(3,2) = -0.599470906677718184951686;
                    M(3,3) = 0.31780961692877601754148;    
                    break;
                
            case(4):
// //             // roots
// //                 root[0][0] = -0.968796
// //                 root[0][1] = -0.345189
// //                 root[1][0] = 0.686545
// //                 root[2][0] = -0.921512
// 
//             // matrix 
//                 M(0,0) = 0.0156891725849398061543027;
//                 M(0,1) = 0.231421090498063614093738;
//                 M(0,2) = 0.505779473833993242770646;
//                 M(0,3) = 0.231421090498063558582587;
//                 M(0,4) = 0.0156891725849398061543027;
//                 M(1,0) = 0.123290991982603792553874;
//                 M(1,1) = -0.674161199540969535703994;
//                 M(1,2) = -0;
//                 M(1,3) = 0.674161199540969424681691;
//                 M(1,4) = -0.123290991982603792553874;
//                 M(2,0) = 0.336045773306330453067403;
//                 M(2,1) = 0.259559789840413945860575;
//                 M(2,2) = -1.19121112629348857581135;
//                 M(2,3) = 0.259559789840413890349424;
//                 M(2,4) = 0.336045773306330453067403;
//                 M(3,0) = 0.368673910840777108166577;
//                 M(3,1) = 0.674161199540969535703994;
//                 M(3,2) = -0;
//                 M(3,3) = -0.674161199540969424681691;
//                 M(3,4) = -0.368673910840777108166577;
//                 M(4,0) = 0.140288528034966247792781;
//                 M(4,1) = -0.490980880338477532198738;
//                 M(4,2) = 0.701384704607022180233855;
//                 M(4,3) = -0.490980880338477421176435;
//                 M(4,4) = 0.140288528034966247792781;                
//                 break;
                
//                 // roots
//                     root[0][0] = -0.896271
//                     root[0][1] = 0.0386876
//                     root[1][0] = 0.591472
//                     root[2][0] = -0.949724

                // matrix 
                    M(0,0) = 0.000358205298408901650492053;
                    M(0,1) = 0.223129313273433382835975;
                    M(0,2) = 0.553024962856315638326521;
                    M(0,3) = 0.223129313273433493858278;
                    M(0,4) = 0.000358205298408901216811184;
                    M(1,0) = -0.0177185044079477688194757;
                    M(1,1) = -0.754488626703529341455123;
                    M(1,2) = -0;
                    M(1,3) = 0.754488626703529785544333;
                    M(1,4) = 0.017718504407947748002794;
                    M(2,0) = 0.198448981355046016883392;
                    M(2,1) = 0.41467694296617996219112;
                    M(2,2) = -1.22625184864245184712672;
                    M(2,3) = 0.414676942966180184235725;
                    M(2,4) = 0.198448981355045794838787;
                    M(3,0) = 0.510994243597973851755967;
                    M(3,1) = 0.754488626703529341455123;
                    M(3,2) = -0;
                    M(3,3) = -0.754488626703529785544333;
                    M(3,4) = -0.510994243597973296644454;
                    M(4,0) = 0.297927024447659005712552;
                    M(4,1) = -0.637806256239613400538246;
                    M(4,2) = 0.679758463583909455785204;
                    M(4,3) = -0.637806256239613733605154;
                    M(4,4) = 0.297927024447658672645645;    
                    break;
                
            case(5):
// //             // roots
// //                 root[0][0] = -0.977397
// //                 root[0][1] = 0.844024
// //                 root[2][0] = -0.111505
// //                 root[2][1] = 0.827503
// //                 root[4][0] = -0.943804
// //                 root[4][1] = -0.342305
// 
//             // matrix 
//                 M(0,0) = 0.436657200244728982418962;
//                 M(0,1) = 0.061734382555204601883414;
//                 M(0,2) = 0.00160841720006663991063278;
//                 M(0,3) = 0.00160841720006664012747322;
//                 M(0,4) = 0.061734382555204601883414;
//                 M(0,5) = 0.436657200244728982418962;
//                 M(1,0) = -0.577850004432976738222294;
//                 M(1,1) = -0.429783849552467900334563;
//                 M(1,2) = 0.0233534111796000302951892;
//                 M(1,3) = -0.0233534111796000337646362;
//                 M(1,4) = 0.429783849552467900334563;
//                 M(1,5) = 0.577850004432976738222294;
//                 M(2,0) = -0.906025575081091827378543;
//                 M(2,1) = 0.869001634017956603450727;
//                 M(2,2) = 0.0370239410631347659608181;
//                 M(2,3) = 0.037023941063134772899712;
//                 M(2,4) = 0.869001634017956603450727;
//                 M(2,5) = -0.906025575081091827378543;
//                 M(3,0) = 1.21837234693771123694717;
//                 M(3,1) = -0.160883268637250165244978;
//                 M(3,2) = -0.332513871662994398015201;
//                 M(3,3) = 0.332513871662994453526352;
//                 M(3,4) = 0.160883268637250165244978;
//                 M(3,5) = -1.21837234693771123694717;
//                 M(4,0) = 0.4704830936880077807416;
//                 M(4,1) = -0.929928045510985734622977;
//                 M(4,2) = 0.459444951822977898370226;
//                 M(4,3) = 0.459444951822977953881377;
//                 M(4,4) = -0.929928045510985734622977;
//                 M(4,5) = 0.4704830936880077807416;
//                 M(5,0) = -0.641637061356379212462286;
//                 M(5,1) = 0.591475089251893626496326;
//                 M(5,2) = -0.18891684960278495863939;
//                 M(5,3) = 0.188916849602784986394965;
//                 M(5,4) = -0.591475089251893626496326;
//                 M(5,5) = 0.641637061356379212462286;                
//                 break;
                
//             // roots
//                 root[0][0] = -0.950866
//                 root[0][1] = -0.305113
//                 root[2][0] = -0.97151
//                 root[2][1] = 0.770326
//                 root[4][0] = -0.136072
//                 root[4][1] = 0.64996

            // matrix 
                M(0,0) = 0.0540046130120444486943931;
                M(0,1) = 0.00191412430029309476448018;
                M(0,2) = 0.444081262687662015054002;
                M(0,3) = 0.444081262687662237098607;
                M(0,4) = 0.00191412430029309498132062;
                M(0,5) = 0.0540046130120444001221358;
                M(1,0) = 0.413583537446564231121471;
                M(1,1) = -0.0203299212984899453637855;
                M(1,2) = -0.682843120109511869664232;
                M(1,3) = 0.682843120109512313753442;
                M(1,4) = 0.0203299212984899453637855;
                M(1,5) = -0.413583537446563898054563;
                M(2,0) = 0.916831321052772096891204;
                M(2,1) = -0.00090524763415951762460937;
                M(2,2) = -0.915926073418611541576695;
                M(2,3) = -0.915926073418612096688207;
                M(2,4) = -0.000905247634159517733029587;
                M(2,5) = 0.916831321052771319735086;
                M(3,0) = 0.227279078819865504312858;
                M(3,1) = 0.272850648219815805628485;
                M(3,2) = 1.47372635101698712389862;
                M(3,3) = -1.47372635101698801207704;
                M(3,4) = -0.272850648219815861139637;
                M(3,5) = -0.227279078819865310023829;
                M(4,0) = -0.970088002040252028734812;
                M(4,1) = 0.496226228788997192342691;
                M(4,2) = 0.47386177325125433679176;
                M(4,3) = 0.473861773251254614347516;
                M(4,4) = 0.496226228788997247853843;
                M(4,5) = -0.970088002040251140556393;
                M(5,0) = -0.641610548290994286979583;
                M(5,1) = 0.244714378533804816084896;
                M(5,2) = -0.792900193427779953481149;
                M(5,3) = 0.792900193427780397570359;
                M(5,4) = -0.244714378533804843840471;
                M(5,5) = 0.64161054829099373186807;                
                break;
                
            case(6):
// //              roots                    
// //             root[0][0] = -1
// //             root[0][1] = -0.862505
// //             root[0][2] = -0.0893251
// //             root[1][0] = -0.937436
// //             root[1][1] = -0.421759
// //             root[2][0] = -0.952946
// //             root[2][1] = 0.663666
// //             root[2][2] = 0.965913
// //             root[3][0] = 0.831505
// 
//         // matrix 
//             M(0,0) = 0.000354713629261486007235304;
//             M(0,1) = 0.0453840805027243762714839;
//             M(0,2) = 0.247471469135075561318615;
//             M(0,3) = 0.413579473465877367477361;
//             M(0,4) = 0.247471469135075644585342;
//             M(0,5) = 0.0453840805027243415770144;
//             M(0,6) = 0.000354713629261485194083675;
//             M(1,0) = 0.00947403158512121791601235;
//             M(1,1) = 0.312039241235410103048054;
//             M(1,2) = -0.738798263374833230621164;
//             M(1,3) = -0;
//             M(1,4) = 0.738798263374833452665769;
//             M(1,5) = -0.312039241235409881003449;
//             M(1,6) = -0.00947403158512119709933064;
//             M(2,0) = 0.0812331476384553774483521;
//             M(2,1) = 0.720550595477885691408915;
//             M(2,2) = 0.00318212494832647435627493;
//             M(2,3) = -1.60993173612933371252609;
//             M(2,4) = 0.00318212494832647522363667;
//             M(2,5) = 0.720550595477885136297402;
//             M(2,6) = 0.0812331476384551831593228;
//             M(3,0) = 0.249225129889075247557884;
//             M(3,1) = 0.477189937035937872256142;
//             M(3,2) = 1.62853437438781800672416;
//             M(3,3) = -0;
//             M(3,4) = -1.62853437438781845081337;
//             M(3,5) = -0.477189937035937539189234;
//             M(3,6) = -0.249225129889074664690796;
//             M(4,0) = 0.350633053944859163220116;
//             M(4,1) = -0.475605032667500038368047;
//             M(4,2) = -0.905786893111698576674939;
//             M(4,3) = 2.06151774366868023591337;
//             M(4,4) = -0.905786893111698909741847;
//             M(4,5) = -0.475605032667499649789988;
//             M(4,6) = 0.350633053944858330552847;
//             M(5,0) = 0.233281432635904811823124;
//             M(5,1) = -0.789229178271347975304195;
//             M(5,2) = -0.897423086291199267883201;
//             M(5,3) = -0;
//             M(5,4) = 0.897423086291199600950108;
//             M(5,5) = 0.789229178271347420192683;
//             M(5,6) = -0.233281432635904284467188;
//             M(6,0) = 0.0597596788975253354059269;
//             M(6,1) = -0.29032964331311000849567;
//             M(6,2) = 0.663152704918196223005111;
//             M(6,3) = -0.865165481005223724331188;
//             M(6,4) = 0.663152704918196445049716;
//             M(6,5) = -0.290329643313109786451065;
//             M(6,6) = 0.0597596788975251966280489;
//             break;
                
//             // roots
//                 root[0][0] = -0.968378
//                 root[0][1] = -0.514013
//                 root[0][2] = 0.976802
//                 root[1][0] = -0.780443
//                 root[1][1] = -0.163119
//                 root[2][0] = -0.954293
//                 root[2][1] = -0.488162
//                 root[2][2] = 0.23927
//                 root[3][0] = 0.866939

            // matrix 
                M(0,0) = 0.212041634313854449045422;
                M(0,1) = 0.00992551758287578585193689;
                M(0,2) = 0.0025247899926373563658788;
                M(0,3) = 0.551016116221264895536081;
                M(0,4) = 0.00252478999263735896796401;
                M(0,5) = 0.00992551758287578932138384;
                M(0,6) = 0.21204163431385433802312;
                M(1,0) = 0.828820079080903049373319;
                M(1,1) = 0.147132034112475412745979;
                M(1,2) = -0.00546860754827236447001004;
                M(1,3) = -0;
                M(1,4) = 0.00546860754827236967418047;
                M(1,5) = -0.147132034112475468257131;
                M(1,6) = -0.828820079080902716306412;
                M(2,0) = 0.368931169345726228669946;
                M(2,1) = 0.691264134506280214509388;
                M(2,2) = -0.0515459916725069314247243;
                M(2,3) = -2.01729862435899853778665;
                M(2,4) = -0.0515459916725069799969816;
                M(2,5) = 0.691264134506280436553993;
                M(2,6) = 0.368931169345726006625341;
                M(3,0) = -1.73406803054315217238468;
                M(3,1) = 1.00860994032383355367699;
                M(3,2) = 0.0137279213364920396611701;
                M(3,3) = -0;
                M(3,4) = -0.0137279213364920535389579;
                M(3,5) = -1.0086099403238339977662;
                M(3,6) = 1.73406803054315128420626;
                M(4,0) = -1.47536700842245460663094;
                M(4,1) = -0.0887540101745947496159062;
                M(4,2) = 0.343248024389899708541662;
                M(4,3) = 2.44174598841429801865388;
                M(4,4) = 0.34324802438990004160857;
                M(4,5) = -0.0887540101745947773714818;
                M(4,6) = -1.47536700842245371845252;
                M(5,0) = 0.906977435638856244182193;
                M(5,1) = -1.15574197443630910520085;
                M(5,2) = 0.48901258597381447312813;
                M(5,3) = -0;
                M(5,4) = -0.489012585973814972728491;
                M(5,5) = 1.15574197443630954929006;
                M(5,6) = -0.906977435638855800092983;
                M(6,0) = 0.896951492077655676560255;
                M(6,1) = -0.61243564191456134615521;
                M(6,2) = 0.20321588997518819086352;
                M(6,3) = -0.975463480276564265381012;
                M(6,4) = 0.203215889975188385152549;
                M(6,5) = -0.612435641914561568199815;
                M(6,6) = 0.896951492077655232471045;
                break;
    
                
            default:
                break;
        }
        mat_order_[i]= re_order(M);                
        mat_inverse_order_[i] = mat_order_[i].inverse();

//         if ( ! check_matrix_is_one(mat_order_[i]) )
        check_matrix_quasi_null_coeff(mat_order_[i],mat_inverse_order_[i]);
        
        
    }    
}
       
#endif // IPOPT_FOUND
