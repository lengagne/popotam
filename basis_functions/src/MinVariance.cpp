#ifdef IPOPT_FOUND

#include "MinVariance.h"
       
MinVariance::MinVariance(): OptimizedBasisFunction("MinVariance")
{
    for (uint i=2;i<=6;i++)
    {
        Eigen::Matrix<double,Eigen::Dynamic,Eigen::Dynamic> M(i+1,i+1);
        switch(i)
        {
            case(2):
                M(0,0) = 0.249987443692760158420185;
                M(0,1) = 0.500025112614479794181932;
                M(0,2) = 0.249987443692760158420185;
                M(1,0) = 0.499999999369356629141947;
                M(1,1) = -0;
                M(1,2) = -0.499999999369356629141947;
                M(2,0) = 0.250012556307239897090966;
                M(2,1) = -0.500025112614479794181932;
                M(2,2) = 0.250012556307239897090966;
                break;
                
            case(3):
//             // roots
//                 root[0][0] = -0.952253
//                 root[2][0] = 0.34578
                M(0,0) = 0.467069386017669507804584;
                M(0,1) = 0.0329306139823304921954161;
                M(0,2) = 0.0329306139823304921954161;
                M(0,3) = 0.467069386017669507804584;
                M(1,0) = 0.513908306390168601041069;
                M(1,1) = 0.223402272459962164541381;
                M(1,2) = -0.223402272459962164541381;
                M(1,3) = -0.513908306390168601041069;
                M(2,0) = -0.465895104140427007699543;
                M(2,1) = 0.465895104140427007699543;
                M(2,2) = 0.465895104140427007699543;
                M(2,3) = -0.465895104140427007699543;
                M(3,0) = -0.515082588267411045634958;
                M(3,1) = 0.275423445662795307598003;
                M(3,2) = -0.275423445662795307598003;
                M(3,3) = 0.515082588267411045634958;                
                break;

            case(4):
//             // roots
//                 root[0][0] = -0.968796
//                 root[0][1] = -0.345189
//                 root[1][0] = 0.686545
//                 root[2][0] = -0.921512

            // matrix 
                M(0,0) = 0.0156891725849398061543027;
                M(0,1) = 0.231421090498063614093738;
                M(0,2) = 0.505779473833993242770646;
                M(0,3) = 0.231421090498063558582587;
                M(0,4) = 0.0156891725849398061543027;
                M(1,0) = 0.123290991982603792553874;
                M(1,1) = -0.674161199540969535703994;
                M(1,2) = -0;
                M(1,3) = 0.674161199540969424681691;
                M(1,4) = -0.123290991982603792553874;
                M(2,0) = 0.336045773306330453067403;
                M(2,1) = 0.259559789840413945860575;
                M(2,2) = -1.19121112629348857581135;
                M(2,3) = 0.259559789840413890349424;
                M(2,4) = 0.336045773306330453067403;
                M(3,0) = 0.368673910840777108166577;
                M(3,1) = 0.674161199540969535703994;
                M(3,2) = -0;
                M(3,3) = -0.674161199540969424681691;
                M(3,4) = -0.368673910840777108166577;
                M(4,0) = 0.140288528034966247792781;
                M(4,1) = -0.490980880338477532198738;
                M(4,2) = 0.701384704607022180233855;
                M(4,3) = -0.490980880338477421176435;
                M(4,4) = 0.140288528034966247792781;                
                break;
                
            case(5):
//             // roots
//                 root[0][0] = -0.977397
//                 root[0][1] = 0.844024
//                 root[2][0] = -0.111505
//                 root[2][1] = 0.827503
//                 root[4][0] = -0.943804
//                 root[4][1] = -0.342305

            // matrix 
                M(0,0) = 0.436657200244728982418962;
                M(0,1) = 0.061734382555204601883414;
                M(0,2) = 0.00160841720006663991063278;
                M(0,3) = 0.00160841720006664012747322;
                M(0,4) = 0.061734382555204601883414;
                M(0,5) = 0.436657200244728982418962;
                M(1,0) = -0.577850004432976738222294;
                M(1,1) = -0.429783849552467900334563;
                M(1,2) = 0.0233534111796000302951892;
                M(1,3) = -0.0233534111796000337646362;
                M(1,4) = 0.429783849552467900334563;
                M(1,5) = 0.577850004432976738222294;
                M(2,0) = -0.906025575081091827378543;
                M(2,1) = 0.869001634017956603450727;
                M(2,2) = 0.0370239410631347659608181;
                M(2,3) = 0.037023941063134772899712;
                M(2,4) = 0.869001634017956603450727;
                M(2,5) = -0.906025575081091827378543;
                M(3,0) = 1.21837234693771123694717;
                M(3,1) = -0.160883268637250165244978;
                M(3,2) = -0.332513871662994398015201;
                M(3,3) = 0.332513871662994453526352;
                M(3,4) = 0.160883268637250165244978;
                M(3,5) = -1.21837234693771123694717;
                M(4,0) = 0.4704830936880077807416;
                M(4,1) = -0.929928045510985734622977;
                M(4,2) = 0.459444951822977898370226;
                M(4,3) = 0.459444951822977953881377;
                M(4,4) = -0.929928045510985734622977;
                M(4,5) = 0.4704830936880077807416;
                M(5,0) = -0.641637061356379212462286;
                M(5,1) = 0.591475089251893626496326;
                M(5,2) = -0.18891684960278495863939;
                M(5,3) = 0.188916849602784986394965;
                M(5,4) = -0.591475089251893626496326;
                M(5,5) = 0.641637061356379212462286;                
                break;
         
            case(6):
//         // roots
//             root[0][0] = -1
//             root[0][1] = -0.862505
//             root[0][2] = -0.0893251
//             root[1][0] = -0.937436
//             root[1][1] = -0.421759
//             root[2][0] = -0.952946
//             root[2][1] = 0.663666
//             root[2][2] = 0.965913
//             root[3][0] = 0.831505

        // matrix 
            M(0,0) = 0.000354713629261486007235304;
            M(0,1) = 0.0453840805027243762714839;
            M(0,2) = 0.247471469135075561318615;
            M(0,3) = 0.413579473465877367477361;
            M(0,4) = 0.247471469135075644585342;
            M(0,5) = 0.0453840805027243415770144;
            M(0,6) = 0.000354713629261485194083675;
            M(1,0) = 0.00947403158512121791601235;
            M(1,1) = 0.312039241235410103048054;
            M(1,2) = -0.738798263374833230621164;
            M(1,3) = -0;
            M(1,4) = 0.738798263374833452665769;
            M(1,5) = -0.312039241235409881003449;
            M(1,6) = -0.00947403158512119709933064;
            M(2,0) = 0.0812331476384553774483521;
            M(2,1) = 0.720550595477885691408915;
            M(2,2) = 0.00318212494832647435627493;
            M(2,3) = -1.60993173612933371252609;
            M(2,4) = 0.00318212494832647522363667;
            M(2,5) = 0.720550595477885136297402;
            M(2,6) = 0.0812331476384551831593228;
            M(3,0) = 0.249225129889075247557884;
            M(3,1) = 0.477189937035937872256142;
            M(3,2) = 1.62853437438781800672416;
            M(3,3) = -0;
            M(3,4) = -1.62853437438781845081337;
            M(3,5) = -0.477189937035937539189234;
            M(3,6) = -0.249225129889074664690796;
            M(4,0) = 0.350633053944859163220116;
            M(4,1) = -0.475605032667500038368047;
            M(4,2) = -0.905786893111698576674939;
            M(4,3) = 2.06151774366868023591337;
            M(4,4) = -0.905786893111698909741847;
            M(4,5) = -0.475605032667499649789988;
            M(4,6) = 0.350633053944858330552847;
            M(5,0) = 0.233281432635904811823124;
            M(5,1) = -0.789229178271347975304195;
            M(5,2) = -0.897423086291199267883201;
            M(5,3) = -0;
            M(5,4) = 0.897423086291199600950108;
            M(5,5) = 0.789229178271347420192683;
            M(5,6) = -0.233281432635904284467188;
            M(6,0) = 0.0597596788975253354059269;
            M(6,1) = -0.29032964331311000849567;
            M(6,2) = 0.663152704918196223005111;
            M(6,3) = -0.865165481005223724331188;
            M(6,4) = 0.663152704918196445049716;
            M(6,5) = -0.290329643313109786451065;
            M(6,6) = 0.0597596788975251966280489;
            break;
    
                
            default:
                break;
        }
        mat_order_[i]= re_order(M);
        mat_inverse_order_[i] = mat_order_[i].inverse();
    }    
}
       
#endif // IPOPT_FOUND
